<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sending payments - Breez SDK - Liquid</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../styles.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Breez SDK - Liquid</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/breez/breez-sdk-liquid-docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/breez/breez-sdk-liquid-docs/edit/main/src/guide/send_payment.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="sending-payments"><a class="header" href="#sending-payments">Sending payments</a></h1>
<p>Once the SDK is initialized, you can directly begin sending payments. The send process takes two steps:</p>
<ol>
<li><a href="send_payment.html#preparing-payments">Preparing the Payment</a></li>
<li><a href="send_payment.html#sending-payments-1">Sending the Payment</a></li>
</ol>
<div class="warning">
<h4 id="developer-note"><a class="header" href="#developer-note">Developer note</a></h4>
Consider implementing the <a href="/notifications/getting_started.html">Notification Plugin</a> when using the Breez SDK in a mobile application. By registering a webhook the application can receive notifications to process the payment in the background.
</div>
<h2 id="preparing-payments">
    <a class="header" href="#preparing-payments">Preparing Payments</a>
    <a class="tag" target="_blank" href="https://breez.github.io/breez-sdk-liquid/breez_sdk_liquid/sdk/struct.LiquidSdk.html#method.prepare_send_payment">API docs</a>
</h2>
<p>During the prepare step, the SDK ensures that the inputs are valid with respect to the destination,
and also returns the relative fees related to the payment so they can be confirmed.</p>
<p>The <code>destination</code> field of the payment request supports Liquid BIP21, Liquid addresses and Lightning invoices.</p>
<h3 id="lightning"><a class="header" href="#lightning">Lightning</a></h3>
<p>Two types of Lightning destinations are possible: BOLT11 invoices and BOLT12 offers.</p>
<p>When sending a Lightning payment, the swap limits for sending need to be first checked.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">let current_limits = sdk.fetch_lightning_limits().await?;

info!("Minimum amount: {} sats", current_limits.send.min_sat);
info!("Maximum amount: {} sats", current_limits.send.max_sat);</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">let currentLimits = try? sdk.fetchLightningLimits()
if let limits = currentLimits {
    print("Minimum amount, in sats: \(limits.send.minSat)")
    print("Maximum amount, in sats: \(limits.send.maxSat)")
}
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">try {
    val currentLimits = sdk.fetchLightningLimits()
    // Log.v("Breez", "Minimum amount, in sats: ${currentLimits.send.minSat}")
    // Log.v("Breez", "Maximum amount, in sats: ${currentLimits.send.maxSat}")
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">try {
  const currentLimits = await sdk.fetchLightningLimits()

  console.log(`Minimum amount, in sats: ${currentLimits.send.minSat}`)
  console.log(`Maximum amount, in sats: ${currentLimits.send.maxSat}`)
} catch (err) {
  console.error(err)
}
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">try {
  const currentLimits = await fetchLightningLimits()

  console.log(`Minimum amount, in sats: ${currentLimits.send.minSat}`)
  console.log(`Maximum amount, in sats: ${currentLimits.send.maxSat}`)
} catch (err) {
  console.error(err)
}
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">LightningPaymentLimitsResponse currentLimits = await breezSDKLiquid.instance!.fetchLightningLimits();
print("Minimum amount: ${currentLimits.send.minSat} sats");
print("Maximum amount: ${currentLimits.send.maxSat} sats");
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore">try:
    current_limits = sdk.fetch_lightning_limits()
    logging.debug(f"Minimum amount, in sats {current_limits.send.min_sat}")
    logging.debug(f"Maximum amount, in sats {current_limits.send.max_sat}")
    return current_limits
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">if currentLimits, err := sdk.FetchLightningLimits(); err == nil {
    log.Printf("Minimum amount, in sats: %v", currentLimits.Send.MinSat)
    log.Printf("Maximum amount, in sats: %v", currentLimits.Send.MaxSat)
}
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">try
{
    var currentLimits = sdk.FetchLightningLimits();
    Console.WriteLine($"Minimum amount, in sats: {currentLimits.send.minSat}");
    Console.WriteLine($"Maximum amount, in sats: {currentLimits.send.maxSat}");
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<p>This represents the range of valid amounts that can be sent at this point in time. The range may change depending on the swap service parameters or mempool feerate fluctuations.</p>
<div class="warning">
<h4 id="developer-note-1"><a class="header" href="#developer-note-1">Developer note</a></h4>
To reduce invalid payments or errors, fetch these limits right before displaying the Pay Lightning UI and use them to validate user input.
</div>
<h4 id="bolt11-invoice"><a class="header" href="#bolt11-invoice">BOLT11 invoice</a></h4>
<p>For BOLT11 invoices, the amount <strong>must</strong> be set. If the optional prepare request amount is also set, the SDK will make sure the two values match, else an error will be thrown.</p>
<p>The SDK will also validate that the amount is within the send lightning limits of the swap service.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">// Set the bolt11 invoice you wish to pay
let prepare_response = sdk
    .prepare_send_payment(&amp;PrepareSendRequest {
        destination: "&lt;bolt11 invoice&gt;".to_string(),
        amount: None,
    })
    .await?;

// If the fees are acceptable, continue to create the Send Payment
let send_fees_sat = prepare_response.fees_sat;
info!("Fees: {send_fees_sat:?} sats");</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">// Set the bolt11 invoice you wish to pay
let prepareResponse = try? sdk
    .prepareSendPayment(req: PrepareSendRequest (
        destination: "&lt;bolt11 invoice&gt;"
    ))

// If the fees are acceptable, continue to create the Send Payment
let sendFeesSat = prepareResponse!.feesSat
print("Fees: {} sats", sendFeesSat);
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">// Set the bolt11 you wish to pay
val destination = "&lt;bolt11 invoice&gt;"
try {
    val prepareResponse = sdk.prepareSendPayment(PrepareSendRequest(destination))

    // If the fees are acceptable, continue to create the Send Payment
    val sendFeesSat = prepareResponse.feesSat;
    // Log.v("Breez", "Fees: ${sendFeesSat} sats")
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">// Set the bolt11 invoice you wish to pay
const prepareResponse = await sdk.prepareSendPayment({
  destination: '&lt;bolt11 invoice&gt;'
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">// Set the bolt11 invoice you wish to pay
const prepareResponse = await prepareSendPayment({
  destination: '&lt;bolt11 invoice&gt;'
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">// Set the bolt11 invoice you wish to pay
PrepareSendRequest prepareSendRequest = PrepareSendRequest(destination: "&lt;bolt11 invoice&gt;");

PrepareSendResponse prepareSendResponse = await breezSDKLiquid.instance!.prepareSendPayment(
  req: prepareSendRequest,
);

// If the fees are acceptable, continue to create the Send Payment
BigInt? sendFeesSat = prepareSendResponse.feesSat;
print("Fees: $sendFeesSat sats");
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore"># Set the bolt11 invoice you wish to pay
destination = "&lt;bolt11 invoice&gt;"
try:
    prepare_response = sdk.prepare_send_payment(
        PrepareSendRequest(
            destination=destination
        )
    )

    # If the fees are acceptable, continue to create the Send Payment
    send_fees_sat = prepare_response.fees_sat
    logging.debug(f"Fees: {send_fees_sat} sats")
    return prepare_response
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">// Set the bolt11 invoice you wish to pay
destination := "&lt;bolt11 invoice&gt;"
prepareRequest := breez_sdk_liquid.PrepareSendRequest{
    Destination: destination,
}
prepareResponse, err := sdk.PrepareSendPayment(prepareRequest)
if err != nil {
    log.Printf("Error: %#v", err)
    return
}

sendFeesSat := prepareResponse.FeesSat
log.Printf("Fees: %v sats", sendFeesSat)
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">// Set the bolt11 invoice you wish to pay
var destination = "&lt;bolt11 invoice&gt;";
try
{
    var prepareResponse = sdk.PrepareSendPayment(new PrepareSendRequest(destination));

    // If the fees are acceptable, continue to create the Send Payment
    var sendFeesSat = prepareResponse.feesSat;
    Console.WriteLine($"Fees: {sendFeesSat} sats");
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h4 id="bolt12-offer"><a class="header" href="#bolt12-offer">BOLT12 offer</a></h4>
<p>Payments to a BOLT12 offer can be done in a similar way. However, when paying to a BOLT12 offer, the SDK's prepare request <strong>must</strong> include an amount.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">// Set the bolt12 offer you wish to pay to
let optional_amount = Some(PayAmount::Bitcoin {
    receiver_amount_sat: 5_000,
});
let prepare_response = sdk
    .prepare_send_payment(&amp;PrepareSendRequest {
        destination: "&lt;bolt12 offer&gt;".to_string(),
        amount: optional_amount,
    })
    .await?;</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">// Set the bolt12 offer you wish to pay
let optionalAmount = PayAmount.bitcoin(receiverAmountSat: 5_000)
let prepareResponse = try? sdk
    .prepareSendPayment(req: PrepareSendRequest (
        destination: "&lt;bolt12 offer&gt;",
        amount: optionalAmount
    ))
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">// Set the bolt12 offer you wish to pay
val destination = "&lt;bolt12 offer&gt;"
try {
    val optionalAmount = PayAmount.Bitcoin(5_000.toULong())
    val prepareRequest = PrepareSendRequest(destination, optionalAmount)
    val prepareResponse = sdk.prepareSendPayment(prepareRequest)
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">// Set the bolt12 offer you wish to pay
const optionalAmount: PayAmount = {
  type: 'bitcoin',
  receiverAmountSat: 5_000
}

const prepareResponse = await sdk.prepareSendPayment({
  destination: '&lt;bolt12 offer&gt;',
  amount: optionalAmount
})
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">// Set the bolt12 offer you wish to pay
const optionalAmount: PayAmount = {
  type: PayAmountVariant.BITCOIN,
  receiverAmountSat: 5_000
}

const prepareResponse = await prepareSendPayment({
  destination: '&lt;bolt12 offer&gt;',
  amount: optionalAmount
})
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">// Set the bolt12 offer you wish to pay
PayAmount_Bitcoin optionalAmount = PayAmount_Bitcoin(receiverAmountSat: 5000 as BigInt);
PrepareSendRequest prepareSendRequest = PrepareSendRequest(
  destination: "&lt;bolt12 offer&gt;",
  amount: optionalAmount,
);

PrepareSendResponse prepareSendResponse = await breezSDKLiquid.instance!.prepareSendPayment(
  req: prepareSendRequest,
);
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore"># Set the bolt12 offer you wish to pay
destination = "&lt;bolt12 offer&gt;"
try:
    optional_amount = PayAmount.BITCOIN(5_000)

    prepare_response = sdk.prepare_send_payment(
        PrepareSendRequest(
            destination=destination,
            amount=optional_amount,
        )
    )

    return prepare_response
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">// Set the bolt12 offer you wish to pay
destination := "&lt;bolt12 offer&gt;"
var optionalAmount breez_sdk_liquid.PayAmount = breez_sdk_liquid.PayAmountBitcoin{
    ReceiverAmountSat: uint64(5_000),
}
prepareRequest := breez_sdk_liquid.PrepareSendRequest{
    Destination: destination,
    Amount:      &amp;optionalAmount,
}
prepareResponse, err := sdk.PrepareSendPayment(prepareRequest)
if err != nil {
    log.Printf("Error: %#v", err)
    return
}
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">// Set the bolt12 offer you wish to pay
var destination = "&lt;bolt12 offer&gt;";
try
{
    var optionalAmount = new PayAmount.Bitcoin(5000);
    var prepareRequest = new PrepareSendRequest(destination, optionalAmount);
    var prepareResponse = sdk.PrepareSendPayment(prepareRequest);
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<div class="warning">
<h4 id="developer-note-2"><a class="header" href="#developer-note-2">Developer note</a></h4>
When paying an invoice generated by another Liquid SDK instance, or any other application which uses the Boltz swapper internally, the payment will fall back to a direct onchain payment. 
The advantage of this is the payer will spend less on fees, as they are no longer relying on external services to execute the payment. 
Note that this also means a <a target="_blank" href="https://breez.technology/request-api-key/#contact-us-form-sdk">Breez API key</a> <b>will be required</b> in order for the payment to be executed. 
To learn more about this process and how it works in detail, see the Boltz documentation for  <a target="_blank" href="https://docs.boltz.exchange/v/api/magic-routing-hints">Magic Routing Hints (MRH)</a>.
</div>
<h3 id="bitcoin"><a class="header" href="#bitcoin">Bitcoin</a></h3>
<p>For onchain (Bitcoin) payments, see <a href="pay_onchain.html">Sending an on-chain transaction</a>.</p>
<h3 id="liquid"><a class="header" href="#liquid">Liquid</a></h3>
<p>When sending via Liquid, a BIP21 URI or Liquid address can be used as the destination.</p>
<p>If a Liquid address is used, the optional prepare request amount <strong>must</strong> be set.</p>
<p>If a BIP21 URI is used, either the BIP21 URI amount or optional prepare request amount <strong>must</strong> be set. When both amounts are set, the SDK will prioritize the <strong>request amount</strong> over the BIP21 amount.</p>
<p><strong>Note:</strong> If a valid Breez API key is not provided, the method will throw an error requiring you to specify one.</p>
<div class="warning">
<h4 id="developer-note-3"><a class="header" href="#developer-note-3">Developer note</a></h4>
To send non-Bitcoin assets, see <a href="assets.html#sending-a-non-bitcoin-asset">Handling multiple assets</a>.
</div>
<h4 id="setting-the-receiver-amount"><a class="header" href="#setting-the-receiver-amount">Setting the receiver amount</a></h4>
<p>When you want the payment receipient to receive a specific amount.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
let optional_amount = Some(PayAmount::Bitcoin {
    receiver_amount_sat: 5_000,
});
let prepare_response = sdk
    .prepare_send_payment(&amp;PrepareSendRequest {
        destination: "&lt;Liquid BIP21 or address&gt;".to_string(),
        amount: optional_amount,
    })
    .await?;

// If the fees are acceptable, continue to create the Send Payment
let send_fees_sat = prepare_response.fees_sat;
info!("Fees: {send_fees_sat:?} sats");</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
let optionalAmount = PayAmount.bitcoin(receiverAmountSat: 5_000)
let prepareResponse = try? sdk
    .prepareSendPayment(req: PrepareSendRequest (
        destination: "&lt;Liquid BIP21 or address&gt;",
        amount: optionalAmount
    ))

// If the fees are acceptable, continue to create the Send Payment
let sendFeesSat = prepareResponse!.feesSat
print("Fees: {} sats", sendFeesSat);
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
val destination = "&lt;Liquid BIP21 or address&gt;"
try {
    val optionalAmount = PayAmount.Bitcoin(5_000.toULong())
    val prepareResponse = sdk.prepareSendPayment(PrepareSendRequest(destination, optionalAmount))

    // If the fees are acceptable, continue to create the Send Payment
    val sendFeesSat = prepareResponse.feesSat;
    // Log.v("Breez", "Fees: ${sendFeesSat} sats")
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">// Set the Liquid BIP21 or Liquid address you wish to pay
const optionalAmount: PayAmount = {
  type: 'bitcoin',
  receiverAmountSat: 5_000
}

const prepareResponse = await sdk.prepareSendPayment({
  destination: '&lt;Liquid BIP21 or address&gt;',
  amount: optionalAmount
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">// Set the Liquid BIP21 or Liquid address you wish to pay
const optionalAmount: PayAmount = {
  type: PayAmountVariant.BITCOIN,
  receiverAmountSat: 5_000
}

const prepareResponse = await prepareSendPayment({
  destination: '&lt;Liquid BIP21 or address&gt;',
  amount: optionalAmount
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
PayAmount_Bitcoin optionalAmount = PayAmount_Bitcoin(receiverAmountSat: 5000 as BigInt);
PrepareSendRequest prepareSendRequest = PrepareSendRequest(
  destination: "&lt;Liquid BIP21 or address&gt;",
  amount: optionalAmount,
);

PrepareSendResponse prepareSendResponse = await breezSDKLiquid.instance!.prepareSendPayment(
  req: prepareSendRequest,
);

// If the fees are acceptable, continue to create the Send Payment
BigInt? sendFeesSat = prepareSendResponse.feesSat;
print("Fees: $sendFeesSat sats");
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore"># Set the Liquid BIP21 or Liquid address you wish to pay
destination = "&lt;Liquid BIP21 or address&gt;"
try:
    optional_amount = PayAmount.BITCOIN(5_000)
    prepare_response = sdk.prepare_send_payment(
        PrepareSendRequest(
            destination=destination,
            amount=optional_amount
        )
    )

    # If the fees are acceptable, continue to create the Send Payment
    send_fees_sat = prepare_response.fees_sat
    logging.debug(f"Fees: {send_fees_sat} sats")
    return prepare_response
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
destination := "&lt;Liquid BIP21 or address&gt;"
var optionalAmount breez_sdk_liquid.PayAmount = breez_sdk_liquid.PayAmountBitcoin{
    ReceiverAmountSat: uint64(5_000),
}
prepareRequest := breez_sdk_liquid.PrepareSendRequest{
    Destination: destination,
    Amount:      &amp;optionalAmount,
}
prepareResponse, err := sdk.PrepareSendPayment(prepareRequest)
if err != nil {
    log.Printf("Error: %#v", err)
    return
}

sendFeesSat := prepareResponse.FeesSat
log.Printf("Fees: %v sats", sendFeesSat)
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">// Set the Liquid BIP21 or address you wish to pay
var destination = "&lt;Liquid BIP21 or address&gt;";
try
{
    var optionalAmount = new PayAmount.Bitcoin(5000);
    var prepareResponse = sdk.PrepareSendPayment(new PrepareSendRequest(destination, optionalAmount));

    // If the fees are acceptable, continue to create the Send Payment
    var sendFeesSat = prepareResponse.feesSat;
    Console.WriteLine($"Fees: {sendFeesSat} sats");
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h4 id="draining-all-funds"><a class="header" href="#draining-all-funds">Draining all funds</a></h4>
<p>When you want send all funds from your wallet to another address.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
let optional_amount = Some(PayAmount::Drain);
let prepare_response = sdk
    .prepare_send_payment(&amp;PrepareSendRequest {
        destination: "&lt;Liquid BIP21 or address&gt;".to_string(),
        amount: optional_amount,
    })
    .await?;

// If the fees are acceptable, continue to create the Send Payment
let send_fees_sat = prepare_response.fees_sat;
info!("Fees: {send_fees_sat:?} sats");</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
let optionalAmount = PayAmount.drain
let prepareResponse = try? sdk
    .prepareSendPayment(req: PrepareSendRequest (
        destination: "&lt;Liquid BIP21 or address&gt;",
        amount: optionalAmount
    ))

// If the fees are acceptable, continue to create the Send Payment
let sendFeesSat = prepareResponse!.feesSat
print("Fees: {} sats", sendFeesSat);
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
val destination = "&lt;Liquid BIP21 or address&gt;"
try {
    val optionalAmount = PayAmount.Drain
    val prepareResponse = sdk.prepareSendPayment(PrepareSendRequest(destination, optionalAmount))

    // If the fees are acceptable, continue to create the Send Payment
    val sendFeesSat = prepareResponse.feesSat;
    // Log.v("Breez", "Fees: ${sendFeesSat} sats")
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">// Set the Liquid BIP21 or Liquid address you wish to pay
const optionalAmount: PayAmount = {
  type: 'drain'
}

const prepareResponse = await sdk.prepareSendPayment({
  destination: '&lt;Liquid BIP21 or address&gt;',
  amount: optionalAmount
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">// Set the Liquid BIP21 or Liquid address you wish to pay
const optionalAmount: PayAmount = {
  type: PayAmountVariant.DRAIN
}

const prepareResponse = await prepareSendPayment({
  destination: '&lt;Liquid BIP21 or address&gt;',
  amount: optionalAmount
})

// If the fees are acceptable, continue to create the Send Payment
const sendFeesSat = prepareResponse.feesSat
console.log(`Fees: ${sendFeesSat} sats`)
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
PayAmount_Drain optionalAmount = PayAmount_Drain();
PrepareSendRequest prepareSendRequest = PrepareSendRequest(
  destination: "&lt;Liquid BIP21 or address&gt;",
  amount: optionalAmount,
);

PrepareSendResponse prepareSendResponse = await breezSDKLiquid.instance!.prepareSendPayment(
  req: prepareSendRequest,
);

// If the fees are acceptable, continue to create the Send Payment
BigInt? sendFeesSat = prepareSendResponse.feesSat;
print("Fees: $sendFeesSat sats");
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore"># Set the Liquid BIP21 or Liquid address you wish to pay
destination = "&lt;Liquid BIP21 or address&gt;"
try:
    optional_amount = PayAmount.DRAIN
    prepare_response = sdk.prepare_send_payment(
        PrepareSendRequest(
            destination=destination,
            amount=optional_amount
        )
    )

    # If the fees are acceptable, continue to create the Send Payment
    send_fees_sat = prepare_response.fees_sat
    logging.debug(f"Fees: {send_fees_sat} sats")
    return prepare_response
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">// Set the Liquid BIP21 or Liquid address you wish to pay
destination := "&lt;Liquid BIP21 or address&gt;"
var optionalAmount breez_sdk_liquid.PayAmount = breez_sdk_liquid.PayAmountDrain{}

prepareRequest := breez_sdk_liquid.PrepareSendRequest{
    Destination: destination,
    Amount:      &amp;optionalAmount,
}
prepareResponse, err := sdk.PrepareSendPayment(prepareRequest)
if err != nil {
    log.Printf("Error: %#v", err)
    return
}

sendFeesSat := prepareResponse.FeesSat
log.Printf("Fees: %v sats", sendFeesSat)
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">// Set the Liquid BIP21 or address you wish to pay
var destination = "&lt;Liquid BIP21 or address&gt;";
try
{
    var optionalAmount = new PayAmount.Drain();
    var prepareResponse = sdk.PrepareSendPayment(new PrepareSendRequest(destination, optionalAmount));

    // If the fees are acceptable, continue to create the Send Payment
    var sendFeesSat = prepareResponse.feesSat;
    Console.WriteLine($"Fees: {sendFeesSat} sats");
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h2 id="sending-payments">
    <a class="header" href="#sending-payments">Sending Payments</a>
    <a class="tag" target="_blank" href="https://breez.github.io/breez-sdk-liquid/breez_sdk_liquid/sdk/struct.LiquidSdk.html#method.send_payment">API docs</a>
</h2>
<p>Once the payment has been prepared, all you have to do is pass the prepare response as an argument to the send method.</p>
<p>For BOLT12 payments you can also include an optional payer note, which will be included in the invoice.</p>
<custom-tabs category="lang">
<div slot="title">Rust</div>
<section>
<pre><code class="language-rust ignore">let optional_payer_note = Some("&lt;payer note&gt;".to_string());
let send_response = sdk
    .send_payment(&amp;SendPaymentRequest {
        prepare_response,
        use_asset_fees: None,
        payer_note: optional_payer_note,
    })
    .await?;
let payment = send_response.payment;</code></pre>
</section>
<div slot="title">Swift</div>
<section>
<pre><code class="language-swift ignore">let optionalPayerNote = "&lt;payer note&gt;"
let sendResponse = try? sdk.sendPayment(req: SendPaymentRequest (
    prepareResponse: prepareResponse,
    payerNote: optionalPayerNote
))
let payment = sendResponse!.payment
</code></pre>
</section>
<div slot="title">Kotlin</div>
<section>
<pre><code class="language-kotlin ignore">try {
    val optionalPayerNote = "&lt;payer note&gt;"
    val sendResponse = sdk.sendPayment(SendPaymentRequest(prepareResponse, null, optionalPayerNote))
    val payment = sendResponse.payment
} catch (e: Exception) {
    // handle error
}
</code></pre>
</section>
<div slot="title">Javascript</div>
<section>
<pre><code class="language-typescript">const optionalPayerNote = '&lt;payer note&gt;'
const sendResponse = await sdk.sendPayment({
  prepareResponse,
  payerNote: optionalPayerNote
})
const payment = sendResponse.payment
</code></pre>
</section>
<div slot="title">React Native</div>
<section>
<pre><code class="language-typescript">const optionalPayerNote = '&lt;payer note&gt;'
const sendResponse = await sendPayment({
  prepareResponse,
  payerNote: optionalPayerNote
})
const payment = sendResponse.payment
</code></pre>
</section>
<div slot="title">Dart</div>
<section>
<pre><code class="language-dart ignore">String optionalPayerNote = "&lt;payer note&gt;";
SendPaymentRequest sendPaymentRequest = SendPaymentRequest(
  prepareResponse: prepareResponse,
  payerNote: optionalPayerNote,
);

SendPaymentResponse sendPaymentResponse = await breezSDKLiquid.instance!.sendPayment(
  req: sendPaymentRequest,
);
Payment payment = sendPaymentResponse.payment;
</code></pre>
</section>
<div slot="title">Python</div>
<section>
<pre><code class="language-python ignore">optional_payer_note = "&lt;payer note&gt;"
try:
    send_response = sdk.send_payment(
        SendPaymentRequest(
            prepare_response=prepare_response,
            payer_note=optional_payer_note
        )
    )
    payment = send_response.payment
except Exception as error:
    logging.error(error)
    raise
</code></pre>
</section>
<div slot="title">Go</div>
<section>
<pre><code class="language-go ignore">optionalPayerNote := "&lt;payer note&gt;"
req := breez_sdk_liquid.SendPaymentRequest{
    PrepareResponse: prepareResponse,
    PayerNote:       &amp;optionalPayerNote,
}
if response, err := sdk.SendPayment(req); err == nil {
    payment := response.Payment
    log.Printf("Payment: %#v", payment)
}
</code></pre>
</section>
<div slot="title">C#</div>
<section>
<pre><code class="language-cs ignore">try
{
    var optionalPayerNote = "&lt;payer note&gt;";
    var sendResponse = sdk.SendPayment(new SendPaymentRequest(prepareResponse, null, optionalPayerNote));
    var payment = sendResponse.payment;
}
catch (Exception)
{
    // Handle error
}
</code></pre>
</section>
</custom-tabs>
<h2 id="event-flows"><a class="header" href="#event-flows">Event Flows</a></h2>
<p>Once a send payment is initiated, you can follow and react to the different payment events using the guide below for each payment method. See <a href="/guide/events.html">Listening to events</a> for how to subscribe to events.</p>
<h3 id="lightning-1"><a class="header" href="#lightning-1">Lightning</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Event</th><th>Description</th><th>UX Suggestion</th></tr></thead><tbody>
<tr><td><strong>PaymentPending</strong></td><td>The SDK has broadcast the lockup transaction for the swap.</td><td>Show payment as pending.</td></tr>
<tr><td><strong>PaymentWaitingConfirmation</strong></td><td>If the Lightning invoice contains an <a target="_blank" href="https://docs.boltz.exchange/v/api/magic-routing-hints">MRH</a>, the SDK will instead broadcast a direct Liquid transaction.</td><td>Display successful payment feedback.</td></tr>
<tr><td><strong>PaymentSucceeded</strong></td><td>The swap service has seen the lockup transaction and broadcast the claim transaction, or the direct Liquid transaction (<a target="_blank" href="https://docs.boltz.exchange/v/api/magic-routing-hints">MRH</a>) is confirmed.</td><td>Show payment as complete.</td></tr>
<tr><td><strong>PaymentFailed</strong></td><td>The swap has expired without a lockup transaction.</td><td></td></tr>
<tr><td><strong>PaymentRefundPending</strong></td><td>The swap can be refunded for several reasons. Either the swap/invoice has expired or the swap service failed to pay the invoice. In this case the SDK will broadcast a refund transaction.</td><td></td></tr>
<tr><td><strong>PaymentRefunded</strong></td><td>The refund transaction is confirmed.</td><td></td></tr>
</tbody></table>
</div>
<h3 id="bitcoin-1"><a class="header" href="#bitcoin-1">Bitcoin</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Event</th><th>Description</th><th>UX Suggestion</th></tr></thead><tbody>
<tr><td><strong>PaymentPending</strong></td><td>The SDK has broadcast the Liquid lockup transaction. Once the SDK has seen the Bitcoin lockup transaction, it will broadcast the Bitcoin claim transaction, either when the Bitcoin lockup transaction is confirmed or immediately if it is accepted as a zero-conf payment.</td><td>Show payment as pending.</td></tr>
<tr><td><strong>PaymentWaitingConfirmation</strong></td><td>The Bitcoin claim transaction has been broadcast and is waiting confirmation.</td><td>Display successful payment feedback.</td></tr>
<tr><td><strong>PaymentSucceeded</strong></td><td>The Bitcoin claim transaction is confirmed.</td><td>Show payment as complete.</td></tr>
<tr><td><strong>PaymentFailed</strong></td><td>The swap has expired without a Liquid lockup transaction.</td><td></td></tr>
<tr><td><strong>PaymentRefundPending</strong></td><td>The swap can be refunded for several reasons. Either the swap has expired or the Bitcoin lockup transaction failed to broadcast. In this case the SDK will broadcast a Liquid refund transaction.</td><td></td></tr>
<tr><td><strong>PaymentRefunded</strong></td><td>The Liquid refund transaction is confirmed.</td><td></td></tr>
</tbody></table>
</div>
<h3 id="liquid-1"><a class="header" href="#liquid-1">Liquid</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Event</th><th>Description</th><th>UX Suggestion</th></tr></thead><tbody>
<tr><td><strong>PaymentWaitingConfirmation</strong></td><td>The transaction has been seen.</td><td>Display successful payment feedback.</td></tr>
<tr><td><strong>PaymentSucceeded</strong></td><td>The transaction is confirmed.</td><td>Show payment as complete.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../guide/receiving_payments_offline.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../guide/list_payments.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../guide/receiving_payments_offline.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../guide/list_payments.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../tabs.js"></script>



    </div>
    </body>
</html>
